module Problems.Problem32 where

import Data.List
import Data.List.Split

import Control.Monad
import Control.Monad.State

type SplitWay = [[Int]]


list2num :: [Int] -> Int
list2num []     = 0
list2num (n:ns) = 10 ^ length ns * n + list2num ns


splitWays :: [a] -> SplitWay
splitWays as = let ns = [1..length as] in [[x, y, 4] | x <- ns, y <- ns, x + y == 5]


isPDPair :: [[Int]] -> Bool
isPDPair nss = 
    let ns = map list2num nss in (ns!!0) * (ns!!1) == (ns!!2) 


problem32 :: IO () 
problem32 = do 
    let ns   = [1..9]
        pds  = permutations ns
        ws   = splitWays ns
        ans  = filter isPDPair [ splitPlacesBlanks w pd | w <- ws, pd <- pds ]

    print $ map (map list2num) ans
